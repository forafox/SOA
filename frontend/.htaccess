# Проксирование API запросов для SOA проекта
# Все запросы к /api/* будут проксироваться на бэкенд

# Включаем mod_rewrite
RewriteEngine On

# Проксирование API запросов на бэкенд
# Заменяем /api/ на /SOA-1.0-SNAPSHOT/api/ и проксируем на localhost:37861
RewriteCond %{REQUEST_URI} ^/api/
RewriteRule ^api/(.*)$ https://localhost:37861/SOA-1.0-SNAPSHOT/api/$1 [P,L]

# Альтернативный вариант - если нужно проксировать все запросы к /SOA-1.0-SNAPSHOT/
# RewriteCond %{REQUEST_URI} ^/SOA-1.0-SNAPSHOT/
# RewriteRule ^SOA-1.0-SNAPSHOT/(.*)$ https://localhost:37861/SOA-1.0-SNAPSHOT/$1 [P,L]

# Настройки для CORS (если нужно)
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization"

# Обработка OPTIONS запросов для CORS
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Кэширование статических файлов
<FilesMatch "\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
    Header set Cache-Control "public, immutable"
</FilesMatch>

# Сжатие файлов
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>
